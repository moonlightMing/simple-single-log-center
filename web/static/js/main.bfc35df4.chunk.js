(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{185:function(e,t,n){e.exports=n(386)},190:function(e,t,n){},209:function(e,t,n){},310:function(e,t,n){},328:function(e,t,n){},336:function(e,t,n){},382:function(e,t,n){},384:function(e,t,n){},386:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(9),o=n.n(i),s=(n(190),n(192),n(75)),c=n(64),l=(n(209),n(24)),p=n(25),u=n(48),m=n(175),h=n(38),d=Object(h.fromJS)({dirData:[],isSpinning:!0}),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"logWindow/CHANGE_WATCH_HSOT":return e.set("watchHost",t.host);case"logWindow/CHANGE_ROUTER":return e.set("routers",t.routers);case"logWindow/GET_DIR_ITEM":return e.merge({dirData:t.data},{isSpinning:!1});case"logWindow/SET_SPIN_STATUS":return e.set("isSpinning",t.isSpinning);default:return e}},g=Object(h.fromJS)({hostList:[],isWebTerminalOpen:!1}),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;return"hostTree/INIT_HOST_LIST"===t.type?e.set("hostList",t.data):"hostTree/IS_WEB_TERMINAL_OPEN"===t.type?e.set("isWebTerminalOpen",t.data):e},v=function(e){return Object(m.combineReducers)({router:Object(c.connectRouter)(e),logWindow:f,hostTree:b})},E=n(176),y=h.default.Map(),O=Object(p.a)(),w=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.c,k=Object(u.d)(v(O),y,w(Object(u.a)(E.a,Object(c.routerMiddleware)(O)))),j=(n(138),n(100)),T=(n(219),n(10)),S=n(26),N=n(27),C=n(30),I=n(28),x=n(31),W=(n(105),n(181)),D=(n(389),n(133)),_=n(390),R=n(56),A=n.n(R),L=n(16),z=n.n(L),M=function(){return function(e){A.a.get("/api/isWebTerminalOpen").then(function(t){var n=t.data,a={type:"hostTree/IS_WEB_TERMINAL_OPEN",data:Object(h.fromJS)(n.result)};e(a)})}},P=D.a.DirectoryTree,U=D.a.TreeNode,B=W.a.Search,H=function e(t,n){for(var a,r=0;r<n.length;r++){var i=n[r];i.children&&(i.children.some(function(e){return e.title===t})?a=i.key:e(t,i.children)&&(a=e(t,i.children)))}return a},G=[],J=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(I.a)(t)).call.apply(e,[this].concat(i)))).state={expandedKeys:["1"],searchValue:"",autoExpandParent:!0,gData:[]},n.onExpand=function(e){n.setState({expandedKeys:e,autoExpandParent:!1})},n.onChange=function(e){var t=e.target.value,a=G.map(function(e){return e.title.indexOf(t)>-1?H(e.title,n.state.gData):null}).filter(function(e,t,n){return e&&n.indexOf(e)===t});n.setState({expandedKeys:a,searchValue:t,autoExpandParent:!0})},n.loop=function(e){return e.map(function(e){var t=n.state.searchValue,a=e.title.indexOf(t),i=e.title.substr(0,a),o=e.title.substr(a+t.length),s=a>-1?r.a.createElement("span",null,i,r.a.createElement("span",{style:{color:"#f50"}},t),o):r.a.createElement("span",null,e.title);return e.children?r.a.createElement(U,{icon:r.a.createElement(T.a,{type:"home"}),key:e.key,title:s},n.loop(e.children)):r.a.createElement(U,{icon:r.a.createElement(T.a,{type:"desktop"}),key:e.key,title:s,host:e.title,isLeaf:!0})})},n}return Object(x.a)(t,e),Object(N.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.props.isWebTerminalOpenAction(),A.a.get("/api/listAllHosts").then(function(t){e.setState({gData:t.data.result})}).catch(function(){j.a.error({title:"ERR_CODE 504",content:"\u7f51\u7edc\u8fde\u63a5\u9519\u8bef"})})}},{key:"onNodeDoubleClick",value:function(e,t){if(t.isLeaf()){var n=this.props,a=n.params,r=n.history;a.host=t.props.host,a.dir="",a.vmode||(a.vmode="grid"),r.push({pathname:"/listdir",search:z.a.stringify(a)})}}},{key:"onNodeRightClick",value:function(e){e.event;var t=e.node;t.isLeaf()&&this.props.isWebTerminalOpen&&window.open("/terminal?host=".concat(t.props.host))}},{key:"render",value:function(){var e=this.state,t=e.expandedKeys,n=e.autoExpandParent,a=e.gData;return function e(t){for(var n=0;n<t.length;n++){var a=t[n],r=a.key;G.push({key:r,title:a.title}),a.children&&e(a.children)}}(a),r.a.createElement("div",{style:{textAlign:"left"}},r.a.createElement(B,{className:"treeNodeUnselectable",style:{marginBottom:8},placeholder:"Search",onChange:this.onChange}),r.a.createElement(P,{expandAction:"doubleClick",onExpand:this.onExpand,expandedKeys:t,autoExpandParent:n,onDoubleClick:this.onNodeDoubleClick.bind(this),onRightClick:this.onNodeRightClick.bind(this)},this.loop(a)))}}]),t}(r.a.Component),K=Object(l.connect)(function(e){return{gData:e.getIn(["hostTree","hostList"]),isWebTerminalOpen:e.getIn(["hostTree","isWebTerminalOpen"]),params:z.a.parse(e.getIn(["router","location","search"]).substring(1))}},function(e){return{isWebTerminalOpenAction:Object(u.b)(M,e)}})(Object(_.a)(J)),q=(n(307),n(182)),V=n(394),X=n(395),F=(n(310),n(160),n(96)),$=(n(387),n(101)),Q=(n(161),n(66)),Y=n(72),Z=(n(388),n(132)),ee=(n(328),function(e){return r.a.createElement(Z.a,{className:"file-card",hoverable:!0,bodyStyle:{padding:10,paddingTop:12,paddingBottom:12}},r.a.createElement(Z.a.Meta,{avatar:0===e.fileType?r.a.createElement(Q.a,{shape:"square",size:"large",icon:"file-text"}):r.a.createElement(Q.a,{shape:"square",size:"large",icon:"folder-open"}),className:"treeNodeUnselectable",title:r.a.createElement("span",{className:"file-name"},e.title)}))}),te=(n(336),function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).state={isSpinning:!0,listData:[],grid:{xs:1,sm:2,md:3,lg:4,xl:5}},n.getDirItem=n.getDirItem.bind(Object(Y.a)(Object(Y.a)(n))),n}return Object(x.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.params,t=e.host,n=e.dir;this.getDirItem(t,n)}},{key:"componentWillReceiveProps",value:function(e){if(e.params.vmode===this.props.params.vmode){var t=e.params.host,n=e.params.dir;t===this.props.params.host&&n===this.props.params.dir||this.getDirItem(t,n)}}},{key:"getDirItem",value:function(e,t){var n=this;"undefined"!==typeof e&&"undefined"!==typeof t&&(this.setState({isSpinning:!0}),A.a.get("/api/listDir",{params:{host:e,path:t}}).then(function(e){var t=e.data.result;n.setState({listData:t,isSpinning:!1})}).catch(function(e){j.a.error({title:"\u7f51\u7edc\u8fde\u63a5\u9519\u8bef",content:"\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u5f00\u542f\u6216\u5bc6\u94a5\u914d\u7f6e"})}))}},{key:"onGridClick",value:function(e,t){var n,a=this.props,r=a.params,i=a.history;n="/"===t.slice(0,1)?r.dir.trim()+t:r.dir.trim()+"/"+t,1===e?i.push({pathname:"/listdir",search:z.a.stringify({host:r.host,dir:n,vmode:r.vmode})}):i.push({pathname:"/logbrowser",search:z.a.stringify({host:r.host,dir:n})})}},{key:"render",value:function(){var e=this;return r.a.createElement(F.a,{spinning:this.state.isSpinning,size:"large",wrapperClassName:"spin"},r.a.createElement($.a,{size:"middle",grid:"list"===this.props.params.vmode?null:this.state.grid,dataSource:this.state.listData,renderItem:function(t){return r.a.createElement($.a.Item,{key:t.name,onClick:e.onGridClick.bind(e,t.type,t.name)},"list"===e.props.params.vmode?r.a.createElement($.a.Item.Meta,{avatar:0===t.type?r.a.createElement(Q.a,{size:"large",shape:"square",icon:"file-text"}):r.a.createElement(Q.a,{size:"large",shape:"square",icon:"folder-open"}),key:t.name,title:r.a.createElement("span",{className:"file-name treeNodeUnselectable"},t.name)}):r.a.createElement(ee,{className:"file-card",title:t.name,fileType:t.type}))}}))}}]),t}(r.a.Component)),ne=Object(l.connect)(function(e){return{params:z.a.parse(e.getIn(["router","location","search"]).substring(1))}},null)(te),ae=(n(345),n(183)),re=n(393),ie=n(131),oe=n.n(ie),se=function(e){function t(){return Object(S.a)(this,t),Object(C.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){var e=this.props,t=e.pathname,n=e.params,i=z.a.parse(n.substring(1)),o=i.dir.split("/").slice(1);return r.a.createElement(a.Fragment,null,r.a.createElement("span",{style:{marginRight:"5px"},className:"treeNodeUnselectable"},i.host," : /"),r.a.createElement(ae.a,{className:"treeNodeUnselectable"},o.map(function(e,n){if(n===o.length-1)return r.a.createElement(oe.a,{key:n},e);var a="/"+o.slice(0,n+1).join("/");return r.a.createElement(oe.a,{key:n},r.a.createElement(re.a,{to:{path:t,search:z.a.stringify({host:i.host,dir:a,vmode:i.vmode})}},e))})))}}]),t}(r.a.Component),ce=Object(l.connect)(function(e){return{pathname:e.getIn(["router","location","pathname"]),params:e.getIn(["router","location","search"])}},null)(se),le=n(50),pe=(n(172),n(98)),ue=n(99),me=(n(382),function(e){function t(e){var n;Object(S.a)(this,t),n=Object(C.a)(this,Object(I.a)(t).call(this,e)),le.Terminal.applyAddon(pe),le.Terminal.applyAddon(ue);var a=window.location,r="https:"===a.protocol?"wss://":"ws://",i=z.a.stringify({host:n.props.params.host,path:n.props.params.dir}),o=r+a.hostname+(a.port?":"+a.port:"")+"/api/tailLog?"+i,s=new WebSocket(o),c=new le.Terminal({fontSize:12,cursorBlink:5,scrollback:200,tabStopWidth:5});return n.state={ws:s,term:c},n}return Object(x.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){var e=this.state,t=e.term,n=e.ws;t.open(document.getElementById("xterm-win")),t.attach(n,!1,!0),t.fit()}},{key:"componentDidUpdate",value:function(){this.state.term.fit()}},{key:"componentWillUnmount",value:function(){this.state.term.detach(this.state.ws),this.state.ws.close()}},{key:"render",value:function(){return r.a.createElement("div",{id:"xterm-win"})}}]),t}(r.a.Component)),he=Object(l.connect)(function(e){return{params:z.a.parse(e.getIn(["router","location","search"]).substring(1))}},null)(me),de=(n(77),n(34)),fe=function(e){function t(){return Object(S.a)(this,t),Object(C.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(N.a)(t,[{key:"onClick",value:function(){var e=this.props,t=e.pathname,n=e.params,a="grid"===n.vmode?"list":"grid";this.props.history.push({pathname:t,search:z.a.stringify({host:n.host,vmode:a,dir:n.dir})})}},{key:"render",value:function(){return r.a.createElement(de.a,{style:{marginLeft:"auto",marginRight:"2px"},onClick:this.onClick.bind(this),icon:"grid"===this.props.params.vmode?"ordered-list":"table"})}}]),t}(r.a.Component),ge=Object(l.connect)(function(e){return{pathname:e.getIn(["router","location","pathname"]),params:z.a.parse(e.getIn(["router","location","search"]).substring(1))}},null)(fe),be=function(e){return r.a.createElement(de.a,{style:{marginLeft:"auto",marginRight:"2px"},onClick:function(){return e.history.goBack()},icon:"arrow-left"})},ve=function(e){function t(){return Object(S.a)(this,t),Object(C.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"warpper"},r.a.createElement("div",{className:"nav-hader"},r.a.createElement(V.a,{exact:!0,path:"/",component:null}),r.a.createElement(V.a,{path:"/listdir",component:ce}),r.a.createElement(V.a,{path:"/listdir",component:ge}),r.a.createElement(V.a,{path:"/logbrowser",component:be})),r.a.createElement("div",{className:"window"},r.a.createElement(X.a,null,r.a.createElement(V.a,{exact:!0,path:"/",component:q.a}),r.a.createElement(V.a,{path:"/listdir",component:ne}),r.a.createElement(V.a,{path:"/logbrowser",component:he}))))}}]),t}(r.a.Component),Ee=(n(384),function(e){function t(e){var n;Object(S.a)(this,t),n=Object(C.a)(this,Object(I.a)(t).call(this,e)),le.Terminal.applyAddon(ue),le.Terminal.applyAddon(pe);var a=new le.Terminal({rows:36});return n.state={ws:null,term:a},n}return Object(x.a)(t,e),Object(N.a)(t,[{key:"onWindowResize",value:function(){this.state.term.fit()}},{key:"componentDidMount",value:function(){var e=this.state.term,t=this.props.params,n=t.host,a=t.dir,r=window.location,i="https:"===r.protocol?"wss://":"ws://",o=z.a.stringify({host:n,path:a,termHeight:e.rows,termWidth:e.cols}),s=i+r.hostname+(r.port?":"+r.port:"")+"/api/terminalShell?"+o,c=new WebSocket(s);this.setState({ws:c}),e.open(document.getElementById("terminal-container")),e.fit(),c.onclose=function(){e.detach(c),e.clear(),e.writeln("\r\nThe WebSocket Close...")},e.attach(c,!0,!1),window.addEventListener("resize",this.onWindowResize.bind(this))}},{key:"componentWillUnmount",value:function(){this.state.ws.close(),window.removeEventListener("resize",this.onWindowResize.bind(this))}},{key:"render",value:function(){return r.a.createElement("div",{id:"terminal-container"})}}]),t}(r.a.Component)),ye=Object(l.connect)(function(e){return{params:z.a.parse(e.getIn(["router","location","search"]).substring(1))}},null)(Ee),Oe=s.a.Sider,we=s.a.Content,ke=function(){return r.a.createElement(s.a,{className:"layout"},r.a.createElement(Oe,{className:"sider"},r.a.createElement(K,null)),r.a.createElement(s.a,null,r.a.createElement(we,{className:"content"},r.a.createElement(ve,null))))},je=function(){return r.a.createElement(ye,null)},Te=function(e){var t=e.history;return r.a.createElement(l.Provider,{store:k},r.a.createElement(c.ConnectedRouter,{history:t},r.a.createElement("div",{className:"App"},r.a.createElement(X.a,null,r.a.createElement(V.a,{path:"/terminal",component:je}),r.a.createElement(V.a,{path:"/",component:ke})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Te,{history:O}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[185,2,1]]]);
//# sourceMappingURL=main.bfc35df4.chunk.js.map